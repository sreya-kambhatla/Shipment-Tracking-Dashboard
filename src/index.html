<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FedEx Tracking Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="./styles.css" />
</head>
<body>
    <div class="min-h-screen flex flex-col">
        <!-- Header -->
        <header class="fedex-purple text-white p-4 shadow-md">
            <div class="container mx-auto flex justify-between items-center">
                <div class="flex items-center space-x-2">
                    <svg class="w-8 h-8" viewBox="0 0 50 50" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M0 25H12.5V37.5H25V25H37.5V12.5H25V0H12.5V12.5H0V25Z" fill="#FF6600"/>
                        <path d="M25 25H37.5V37.5H50V25H37.5V12.5H50V0H37.5V12.5H25V25Z" fill="#FF6600"/>
                    </svg>
                    <h1 class="text-xl font-bold">FedEx Tracking Dashboard</h1>
                </div>
                <div class="text-sm">
                    <span id="lastUpdated" class="opacity-75">Last updated: Never</span>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="container mx-auto flex-grow p-4 md:p-6">
            <!-- Import Section -->
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <h2 class="text-lg font-semibold mb-4">Import Tracking Data</h2>
                <div class="flex flex-col md:flex-row gap-4">
                    <div class="flex-grow">
                        <label for="fileInput" class="block text-sm font-medium text-gray-700 mb-1">Excel File (.xlsx)</label>
                        <input type="file" id="fileInput" accept=".xlsx, .xls" class="block w-full text-sm text-gray-500
                            file:mr-4 file:py-2 file:px-4
                            file:rounded-md file:border-0
                            file:text-sm file:font-semibold
                            file:bg-purple-50 file:text-purple-700
                            hover:file:bg-purple-100
                            cursor-pointer border rounded-md p-1">
                    </div>
                    <div class="flex items-end gap-2">
                        <button id="importBtn" class="fedex-purple hover:bg-purple-800 text-white font-medium py-2 px-4 rounded-md transition-colors">
                            Import Data
                        </button>
                        <button id="appendBtn" class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md transition-colors">
                            Append Data
                        </button>
                    </div>
                </div>
                <div class="mt-4 text-sm text-gray-500">
                    <p>Expected Excel format: columns for Ticket Number, Outbound Tracking, and Inbound Tracking</p>
                </div>
            </div>

            <!-- Sample Data Section -->
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-lg font-semibold">No Data? Try Sample Data</h2>
                    <button id="loadSampleBtn" class="bg-gray-100 hover:bg-gray-200 text-gray-800 font-medium py-2 px-4 rounded-md transition-colors text-sm">
                        Load Sample Data
                    </button>
                </div>
            </div>

            <!-- Status Explanation Section -->
            <div class="bg-white rounded-lg shadow-md p-6 mb-6">
                <h2 class="text-lg font-semibold mb-4">Tracking Status Explanations</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <div class="border rounded-md p-3">
                        <div class="flex items-center mb-2">
                            <span class="px-2 py-1 text-xs rounded-full inline-block status-delivered mr-2">Delivered</span>
                            <span class="font-medium">Package Delivered</span>
                        </div>
                        <p class="text-sm text-gray-600">The package has been delivered to its destination and signed for by the recipient.</p>
                    </div>
                    <div class="border rounded-md p-3">
                        <div class="flex items-center mb-2">
                            <span class="px-2 py-1 text-xs rounded-full inline-block status-transit mr-2">In Transit</span>
                            <span class="font-medium">In Transit</span>
                        </div>
                        <p class="text-sm text-gray-600">The package is on its way, moving through the FedEx network between facilities.</p>
                    </div>
                    <div class="border rounded-md p-3">
                        <div class="flex items-center mb-2">
                            <span class="px-2 py-1 text-xs rounded-full inline-block status-transit mr-2">Out for Delivery</span>
                            <span class="font-medium">Out for Delivery</span>
                        </div>
                        <p class="text-sm text-gray-600">The package is on the delivery vehicle and will be delivered today.</p>
                    </div>
                    <div class="border rounded-md p-3">
                        <div class="flex items-center mb-2">
                            <span class="px-2 py-1 text-xs rounded-full inline-block status-pending mr-2">Pending</span>
                            <span class="font-medium">Pending</span>
                        </div>
                        <p class="text-sm text-gray-600">The shipping label has been created, but the package has not yet been picked up or received by FedEx.</p>
                    </div>
                    <div class="border rounded-md p-3">
                        <div class="flex items-center mb-2">
                            <span class="px-2 py-1 text-xs rounded-full inline-block status-exception mr-2">Exception</span>
                            <span class="font-medium">Exception</span>
                        </div>
                        <p class="text-sm text-gray-600">There's a delivery issue such as weather delay, address problem, or customs hold that's preventing normal delivery.</p>
                    </div>
                </div>
            </div>

            <!-- Results Section -->
            <div id="resultsSection" class="bg-white rounded-lg shadow-md p-6 mb-6 hidden">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-lg font-semibold">Tracking Results</h2>
                    <div class="flex gap-2">
                        <button id="refreshBtn" class="bg-blue-50 hover:bg-blue-100 text-blue-700 font-medium py-2 px-4 rounded-md transition-colors text-sm flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                            </svg>
                            Refresh Status
                        </button>
                        <div class="relative">
                            <button id="exportDropdownBtn" class="bg-green-50 hover:bg-green-100 text-green-700 font-medium py-2 px-4 rounded-md transition-colors text-sm flex items-center">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                                </svg>
                                Export
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 ml-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                                </svg>
                            </button>
                            <div id="exportDropdown" class="dropdown-menu">
                                <div class="dropdown-item" id="exportCsvBtn">Export as CSV</div>
                                <div class="dropdown-item" id="exportXlsxBtn">Export as Excel (.xlsx)</div>
                            </div>
                        </div>
                        <button id="clearBtn" class="bg-red-50 hover:bg-red-100 text-red-700 font-medium py-2 px-4 rounded-md transition-colors text-sm flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                            </svg>
                            Clear All
                        </button>
                    </div>
                </div>

                <!-- Filter Section -->
                <div class="mb-6 border rounded-lg p-4 bg-gray-50">
                    <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-3">
                        <h3 class="text-md font-medium mb-2 md:mb-0">Filter & Sort Options</h3>
                        <div class="relative">
                            <button id="filterDropdownBtn" class="bg-white border border-gray-300 hover:bg-gray-50 text-gray-700 font-medium py-2 px-4 rounded-md transition-colors text-sm flex items-center">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z" />
                                </svg>
                                Add Filter
                            </button>
                            <div id="filterDropdown" class="dropdown-menu">
                                <div class="dropdown-item" data-filter="show-all">Show All (Clear Filters)</div>
                                <div class="dropdown-divider"></div>
                                <div class="dropdown-item" data-filter="status-delivered">Show Only Delivered</div>
                                <div class="dropdown-item" data-filter="status-not-delivered">Hide Delivered</div>
                                <div class="dropdown-item" data-filter="status-exception">Show Only Exceptions</div>
                                <div class="dropdown-item" data-filter="status-transit">Show Only In Transit</div>
                                <div class="dropdown-divider"></div>
                                <div class="dropdown-item" data-filter="sort-ticket-asc">Sort by Ticket # (A-Z)</div>
                                <div class="dropdown-item" data-filter="sort-ticket-desc">Sort by Ticket # (Z-A)</div>
                                <div class="dropdown-item" data-filter="sort-date-asc">Sort by Last Update (Oldest)</div>
                                <div class="dropdown-item" data-filter="sort-date-desc">Sort by Last Update (Newest)</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Active Filters -->
                    <div id="activeFilters" class="flex flex-wrap"></div>
                </div>

                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    <button class="sort-header flex items-center" data-sort="ticket">
                                        Ticket #
                                        <span class="sort-icon ml-1"></span>
                                    </button>
                                </th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Outbound Tracking</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Inbound Tracking</th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    <button class="sort-header flex items-center" data-sort="status">
                                        Status
                                        <span class="sort-icon ml-1"></span>
                                    </button>
                                </th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    <button class="sort-header flex items-center" data-sort="date">
                                        Last Update
                                        <span class="sort-icon ml-1"></span>
                                    </button>
                                </th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="trackingResults" class="bg-white divide-y divide-gray-200">
                            <!-- Results will be populated here -->
                        </tbody>
                    </table>
                </div>
                <div id="noResults" class="py-8 text-center text-gray-500 hidden">
                    No tracking data available
                </div>
                <div class="mt-4 text-sm text-gray-500">
                    <span id="trackingCount">0</span> shipments displayed
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="bg-gray-100 text-gray-600 py-4 text-center text-sm">
            <p>This is a demo application. Not affiliated with FedEx.</p>
        </footer>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="fixed bottom-4 right-4 bg-gray-800 text-white px-4 py-2 rounded-md shadow-lg transform transition-transform duration-300 translate-y-20 opacity-0 flex items-center z-50">
        <span id="toastMessage">Message copied to clipboard</span>
    </div>

    <!-- Copy Text Modal -->
    <div id="copyModal" class="modal">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold">Tracking Information</h3>
                <button id="closeModal" class="text-gray-500 hover:text-gray-700">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <div class="mb-4">
                <p class="text-sm text-gray-500 mb-2">Copy the text below:</p>
                <textarea id="copyText" class="w-full h-32 p-2 border border-gray-300 rounded-md text-sm" readonly></textarea>
            </div>
            <div class="flex justify-end">
                <button id="modalCopyBtn" class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md transition-colors text-sm">
                    Copy to Clipboard
                </button>
            </div>
        </div>
    </div>

    <!-- Details Modal -->
    <div id="detailsModal" class="modal">
        <div class="modal-content details-modal">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold">Tracking Details</h3>
                <button id="closeDetailsModal" class="text-gray-500 hover:text-gray-700">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <div id="detailsContent" class="mb-4">
                <!-- Details will be populated here -->
            </div>
            <div class="flex justify-end">
                <button id="closeDetailsBtn" class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-2 px-4 rounded-md transition-colors text-sm">
                    Close
                </button>
            </div>
        </div>
    </div>

    <!-- Confirm Clear Modal -->
    <div id="clearModal" class="modal">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold">Clear All Data</h3>
                <button id="closeClearModal" class="text-gray-500 hover:text-gray-700">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <div class="mb-6">
                <p class="text-gray-700">Are you sure you want to clear all tracking data? This cannot be undone.</p>
            </div>
            <div class="flex justify-end space-x-3">
                <button id="cancelClearBtn" class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-2 px-4 rounded-md transition-colors text-sm">
                    Cancel
                </button>
                <button id="confirmClearBtn" class="bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-md transition-colors text-sm">
                    Clear All Data
                </button>
            </div>
        </div>
    </div>

    <!-- Confirm Delete Modal -->
    <div id="deleteModal" class="modal">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold">Remove Tracking Item</h3>
                <button id="closeDeleteModal" class="text-gray-500 hover:text-gray-700">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <div class="mb-6">
                <p class="text-gray-700">Are you sure you want to remove tracking for <span id="deleteTicketNumber" class="font-semibold"></span>?</p>
            </div>
            <div class="flex justify-end space-x-3">
                <button id="cancelDeleteBtn" class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-2 px-4 rounded-md transition-colors text-sm">
                    Cancel
                </button>
                <button id="confirmDeleteBtn" class="bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-md transition-colors text-sm" data-id="">
                    Remove
                </button>
            </div>
        </div>
    </div>

    <!-- Import Error Modal -->
    <div id="importErrorModal" class="modal">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold">Import Error</h3>
                <button id="closeImportErrorModal" class="text-gray-500 hover:text-gray-700">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <div class="mb-6">
                <p id="importErrorMessage" class="text-gray-700">There was an error importing your data.</p>
                <div class="mt-4 p-3 bg-gray-50 rounded-md text-sm text-gray-600 max-h-40 overflow-y-auto">
                    <p id="importErrorDetails"></p>
                </div>
            </div>
            <div class="flex justify-end">
                <button id="closeImportErrorBtn" class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium py-2 px-4 rounded-md transition-colors text-sm">
                    Close
                </button>
            </div>
        </div>
    </div>

    <!-- Hidden Download Iframe -->
    <iframe id="downloadFrame" style="display:none;"></iframe>

       <!-- REPLACE EVERYTHING FROM: "// Convert data to CSV" TO END OF FILE WITH THIS -->


</body>
</html>
